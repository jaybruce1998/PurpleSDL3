#include "Warp.h"
#include "FlyLocation.h"
#include "Utils.h"

static std::vector<std::string> splitLinesWarp(const std::string &s) {
    std::vector<std::string> lines;
    std::stringstream ss(s);
    std::string line;
    while (std::getline(ss, line)) {
        if (!line.empty() && line.back() == '\r') {
            line.pop_back();
        }
        lines.push_back(line);
    }
    return lines;
}

std::vector<std::string> Warp::WARP_STRINGS = splitLinesWarp(R"(AgathasRoom,4,11,BrunosRoom,5,0
AgathasRoom,4,0,LancesRoom,5,0
AgathasRoom,5,0,LancesRoom,5,0
BrunosRoom,4,11,LoreleisRoom,5,0
BrunosRoom,4,0,AgathasRoom,5,11
BrunosRoom,5,0,AgathasRoom,4,0
CeladonCity,8,13,CeladonMart1F,3,7
CeladonCity,10,13,CeladonMart1F,17,7
CeladonCity,24,9,CeladonMansion1F,5,11
CeladonCity,41,9,CeladonPokecenter,3,7
CeladonCity,12,27,CeladonGym,5,17
CeladonCity,28,19,GameCorner,16,17
CeladonCity,39,19,CeladonMart5F,16,1
CeladonCity,33,19,GameCornerPrizeRoom,5,7
CeladonCity,31,27,CeladonDiner,4,7
CeladonCity,35,27,CeladonChiefHouse,3,7
CeladonCity,43,27,CeladonHotel,4,7
CeruleanCity,27,11,CeruleanTrashedHouse,3,7
CeruleanCity,13,15,CeruleanTradeHouse,3,7
CeruleanCity,19,17,CeruleanPokecenter,3,7
CeruleanCity,30,19,CeruleanGym,5,13
CeruleanCity,13,25,BikeShop,3,7
CeruleanCity,25,25,CeruleanMart,4,7
CeruleanCity,4,11,CeruleanCave1F,25,17
CeruleanCity,9,11,CeruleanBadgeHouse,3,7
CeruleanCity,9,9,CeruleanBadgeHouse,2,0
ChampionsRoom,3,7,LancesRoom,6,0
ChampionsRoom,3,0,HallOfFame,5,7
ChampionsRoom,4,0,HallOfFame,5,7
CinnabarIsland,6,3,PokemonMansion1F,6,27
CinnabarIsland,18,3,CinnabarGym,17,17
CinnabarIsland,6,9,CinnabarLab,3,7
CinnabarIsland,11,11,CinnabarPokecenter,3,7
CinnabarIsland,15,11,CinnabarMart,4,7
CinnabarLab,8,4,CinnabarLabTradeRoom,3,7
CinnabarLab,12,4,CinnabarLabMetronomeRoom,3,7
CinnabarLab,16,4,CinnabarLabFossilRoom,3,7
DiglettsCaveRoute2,4,4,DiglettsCave,5,5
FuchsiaCity,5,13,FuchsiaMart,4,7
FuchsiaCity,11,27,FuchsiaBillsGrandpasHouse,3,7
FuchsiaCity,19,27,FuchsiaPokecenter,3,7
FuchsiaCity,27,27,WardensHouse,5,7
FuchsiaCity,18,3,SafariZoneGate,4,5
FuchsiaCity,5,27,FuchsiaGym,5,17
FuchsiaCity,22,13,FuchsiaMeetingRoom,5,7
FuchsiaCity,31,27,FuchsiaGoodRodHouse,3,7
HallOfFame,4,7,ChampionsRoom,4,0
IndigoPlateauLobby,8,0,LoreleisRoom,5,11
LancesRoom,24,16,AgathasRoom,5,0
LancesRoom,5,0,ChampionsRoom,4,7
LancesRoom,6,0,ChampionsRoom,4,7
LavenderTown,3,5,LavenderPokecenter,3,7
LavenderTown,14,5,PokemonTower1F,11,17
LavenderTown,7,9,MrFujisHouse,3,7
LavenderTown,15,13,LavenderMart,4,7
LavenderTown,3,13,LavenderCuboneHouse,3,7
LavenderTown,7,13,NameRatersHouse,3,7
LoreleisRoom,4,0,BrunosRoom,5,11
LoreleisRoom,5,0,BrunosRoom,4,0
PalletTown,5,5,RedsHouse1F,3,7
PalletTown,13,5,BluesHouse,3,7
PewterCity,14,7,Museum1F,11,7
PewterCity,19,5,Museum1F,17,7
PewterCity,16,17,PewterGym,5,13
PewterCity,29,13,PewterNidoranHouse,3,7
PewterCity,23,17,PewterMart,4,7
PewterCity,7,29,PewterSpeechHouse,3,7
PewterCity,13,25,PewterPokecenter,3,7
Route10,11,19,RockTunnelPokecenter,3,7
Route10,8,17,RockTunnel1F,15,3
Route10,8,53,RockTunnel1F,15,33
Route10,6,39,PowerPlant,5,35
Route11,4,5,DiglettsCaveRoute11,3,7
Route12,11,77,Route12SuperRodHouse,3,7
Route16,7,5,Route16FlyHouse,3,7
Route2,12,9,DiglettsCaveRoute2,3,7
Route2,3,11,ViridianForestNorthGate,5,0
Route2,15,19,Route2TradeHouse,3,7
Route2,15,39,Route2Gate,5,7
Route2,3,43,ViridianForestSouthGate,5,7
Route20,48,5,SeafoamIslands1F,5,17
Route20,58,9,SeafoamIslands1F,27,17
Route22,8,5,Route22Gate,5,7
Route23,4,31,VictoryRoad1F,9,17
Route23,14,31,VictoryRoad2F,29,8
Route25,45,3,BillsHouse,3,7
Route5,9,29,Route5Gate,3,0
Route5,10,29,Route5Gate,4,0
Route5,10,33,Route5Gate,4,5
Route5,17,27,UndergroundPathRoute5,4,7
Route5,10,21,Daycare,3,7
Route4,11,5,MtMoonPokecenter,3,7
Route4,18,5,MtMoon1F,15,35
Route6,9,1,Route6Gate,4,0
Route6,10,1,Route6Gate,4,0
Route6,10,7,Route6Gate,4,5
Route6,17,13,UndergroundPathRoute6,4,7
Route7,5,13,UndergroundPathRoute7,4,7
Route8,1,10,Route8Gate,0,4
Route8,8,10,Route8Gate,5,4
Route8,13,3,UndergroundPathRoute8,4,7
SaffronCity,7,5,CopycatsHouse1F,3,7
SaffronCity,26,3,FightingDojo,5,11
SaffronCity,34,3,SaffronGym,9,17
SaffronCity,13,11,SaffronPidgeyHouse,3,7
SaffronCity,25,11,SaffronMart,4,7
SaffronCity,18,21,SilphCo1F,11,17
SaffronCity,9,29,SaffronPokecenter,3,7
SaffronCity,29,29,MrPsychicsHouse,3,7
UndergroundPathRoute7,4,4,UndergroundPathWestEast,2,5
UndergroundPathRoute5,4,4,UndergroundPathNorthSouth,5,4
VermilionCity,11,3,VermilionPokecenter,3,7
VermilionCity,9,13,PokemonFanClub,3,7
VermilionCity,23,13,VermilionMart,4,7
VermilionCity,12,19,VermilionGym,5,17
VermilionCity,23,19,VermilionPidgeyHouse,3,7
VermilionCity,18,31,VermilionDock,14,2
VermilionCity,19,31,VermilionDock,14,2
VermilionCity,15,13,VermilionTradeHouse,3,7
VermilionCity,7,3,VermilionOldRodHouse,3,7
ViridianCity,23,25,ViridianPokecenter,3,7
ViridianCity,29,19,ViridianMart,4,7
ViridianCity,21,9,ViridianNicknameHouse,3,7
ViridianCity,32,7,ViridianGym,17,17
RedsHouse1F,7,1,RedsHouse2F,7,1
PalletTown,12,11,OaksLab,5,11
ViridianCity,21,15,ViridianBunglerHouse,3,7
Museum1F,7,7,Museum2F,7,7
MtMoon1F,25,15,MtMoonB1F,25,15
MtMoon1F,17,11,MtMoonB1F,25,9
MtMoon1F,5,5,MtMoonB1F,5,5
MtMoonB1F,13,27,MtMoonB2F,15,27
MtMoonB1F,17,11,MtMoonB2F,25,9
MtMoonB1F,21,17,MtMoonB2F,21,17
MtMoonB2F,5,7,MtMoonB1F,23,3
MtMoonB1F,27,3,Route4,24,5
CeruleanTrashedHouse,3,0,CeruleanCity,27,9
UndergroundPathRoute5,3,7,Route5,17,27
UndergroundPathRoute6,4,4,UndergroundPathNorthSouth,2,41
DiglettsCaveRoute11,4,4,DiglettsCave,37,31
RockTunnel1F,37,3,RockTunnelB1F,33,25
RockTunnelB1F,27,3,RockTunnel1F,5,3
RockTunnel1F,17,11,RockTunnelB1F,23,11
RockTunnelB1F,3,3,RockTunnel1F,37,17
PokemonTower1F,18,9,PokemonTower2F,18,9
PokemonTower2F,3,9,PokemonTower3F,3,9,
PokemonTower3F,18,9,PokemonTower4F,18,9
PokemonTower4F,3,9,PokemonTower5F,3,9
PokemonTower5F,18,9,PokemonTower6F,18,9
PokemonTower6F,9,16,PokemonTower7F,9,16
UndergroundPathRoute8,4,4,UndergroundPathWestEast,47,2
CeladonMansion1F,7,1,CeladonMansion2F,7,1
CeladonMansion2F,6,1,CeladonMansion3F,6,1
CeladonMansion3F,7,1,CeladonMansionRoof,6,1
CeladonMart1F,12,1,CeladonMart2F,12,1
CeladonMart2F,16,1,CeladonMart3F,16,1
CeladonMart3F,12,1,CeladonMart4F,12,1
CeladonMart4F,16,1,CeladonMart5F,16,1
CeladonMart5F,12,1,CeladonMartRoof,15,2
GameCorner,17,4,RocketHideoutB1F,21,2
RocketHideoutB1F,23,2,RocketHideoutB2F,27,8
RocketHideoutB2F,21,22,RocketHideoutB1F,21,24
RocketHideoutB2F,21,8,RocketHideoutB3F,25,6
RocketHideoutB3F,19,18,RocketHideoutB4F,19,10
FuchsiaGoodRodHouse,2,0,FuchsiaCity,31,24
SafariZoneGate,3,0,SafariZoneCenter,14,25
SafariZoneGate,4,0,SafariZoneCenter,15,25
SafariZoneCenter,17,19,SafariZoneCenterRestHouse,3,7
SafariZoneCenter,0,10,SafariZoneWest,29,22
SafariZoneCenter,0,11,SafariZoneWest,29,23
SafariZoneCenter,14,0,SafariZoneNorth,20,35
SafariZoneCenter,15,0,SafariZoneNorth,21,35
SafariZoneCenter,29,10,SafariZoneEast,0,22
SafariZoneCenter,29,11,SafariZoneEast,0,23
SafariZoneEast,25,9,SafariZoneEastRestHouse,3,7
SafariZoneEast,0,4,SafariZoneNorth,39,30
SafariZoneEast,0,5,SafariZoneNorth,39,31
SafariZoneNorth,35,3,SafariZoneNorthRestHouse,3,7
SafariZoneNorth,8,35,SafariZoneWest,26,0
SafariZoneNorth,9,35,SafariZoneWest,27,0
SafariZoneNorth,2,35,SafariZoneWest,20,0
SafariZoneNorth,3,35,SafariZoneWest,21,0
SafariZoneWest,3,3,SafariZoneSecretHouse,3,7
SafariZoneWest,11,11,SafariZoneWestRestHouse,3,7
Route12,10,15,Route12Gate1F,4,0
Route12,11,15,Route12Gate1F,5,0
Route12,10,21,Route12Gate1F,5,7
Route12Gate1F,8,6,Route12Gate2F,7,7
CopycatsHouse1F,7,1,CopycatsHouse2F,7,1
SaffronGym,11,15,SaffronGym,19,17
SaffronGym,19,15,SaffronGym,19,9
SaffronGym,19,11,SaffronGym,1,9
SaffronGym,1,11,SaffronGym,5,5
SaffronGym,5,3,SaffronGym,11,3
SaffronGym,11,5,SaffronGym,1,17
SaffronGym,1,15,SaffronGym,19,5
SaffronGym,15,17,SaffronGym,5,15
SaffronGym,15,5,SaffronGym,1,3
SaffronGym,15,9,SaffronGym,15,3
SaffronGym,5,9,SaffronGym,9,5
SaffronGym,1,5,SaffronGym,11,11
SaffronGym,5,11,SaffronGym,5,17
SaffronGym,15,11,SaffronGym,9,3
SaffronGym,15,15,SaffronGym,19,3
PokemonMansion1F,4,27,CinnabarIsland,6,4
PokemonMansion1F,5,10,PokemonMansion2F,5,10
PokemonMansion1F,21,23,PokemonMansionB1F,23,22
PokemonMansion2F,7,10,PokemonMansion3F,7,10
PokemonMansion3F,6,1,PokemonMansion2F,6,1
PokemonMansion3F,25,14,PokemonMansion2F,25,14
SeafoamIslands1F,7,5,SeafoamIslandsB1F,7,5
SeafoamIslands1F,25,3,SeafoamIslandsB1F,25,3
SeafoamIslands1F,17,6,SeafoamIslandsB1F,17,6
SeafoamIslands1F,24,6,SeafoamIslandsB1F,24,6
SeafoamIslandsB1F,4,2,SeafoamIslandsB2F,5,3
SeafoamIslandsB1F,13,7,SeafoamIslandsB2F,13,7
SeafoamIslandsB1F,19,15,SeafoamIslandsB2F,19,15
SeafoamIslandsB1F,18,6,SeafoamIslandsB2F,18,6
SeafoamIslandsB1F,23,6,SeafoamIslandsB2F,23,6
SeafoamIslandsB2F,5,13,SeafoamIslandsB3F,5,12
SeafoamIslandsB2F,19,6,SeafoamIslandsB3F,19,6
SeafoamIslands1F,23,15,SeafoamIslandsB1F,23,15
SeafoamIslandsB1F,25,11,SeafoamIslandsB2F,25,11
SeafoamIslandsB2F,25,14,SeafoamIslandsB3F,25,14
SeafoamIslandsB3F,8,6,SeafoamIslandsB4F,11,7
SeafoamIslandsB4F,25,4,SeafoamIslandsB3F,25,4
SeafoamIslandsB3F,25,3,SeafoamIslandsB2F,25,3
SeafoamIslandsB2F,22,6,SeafoamIslandsB3F,22,6
SeafoamIslandsB3F,3,16,SeafoamIslandsB4F,3,16
SeafoamIslandsB3F,6,16,SeafoamIslandsB4F,6,16
VictoryRoad1F,1,1,VictoryRoad2F,0,8
VictoryRoad2F,1,1,VictoryRoad3F,2,0
VictoryRoad2F,25,14,VictoryRoad3F,27,15
VictoryRoad3F,26,8,VictoryRoad2F,27,7
VictoryRoad2F,23,7,VictoryRoad3F,23,7
VictoryRoad3F,23,15,VictoryRoad2F,22,16
IndigoPlateau,9,5,IndigoPlateauLobby,7,11
IndigoPlateau,10,5,IndigoPlateauLobby,8,11
Route2Gate,5,0,Route2,17,35
SilphCo1F,26,0,SilphCo2F,24,0
SilphCo2F,26,0,SilphCo3F,26,0
SilphCo3F,24,0,SilphCo4F,24,0
SilphCo4F,26,0,SilphCo5F,26,0
SilphCo5F,24,0,SilphCo6F,14,0
SilphCo6F,16,0,SilphCo7F,22,0
SilphCo7F,16,0,SilphCo8F,14,0
SilphCo8F,16,0,SilphCo9F,16,0
SilphCo9F,14,0,SilphCo10F,8,0
SilphCo10F,10,0,SilphCo11F,9,0
SilphCo2F,3,3,SilphCo3F,27,3
SilphCo2F,13,3,SilphCo8F,3,15
SilphCo2F,9,15,SilphCo6F,23,3
SilphCo2F,27,15,SilphCo8F,11,5
SilphCo3F,3,3,SilphCo5F,11,5
SilphCo3F,3,11,SilphCo9F,9,3
SilphCo3F,11,11,SilphCo7F,5,3
SilphCo3F,23,11,SilphCo3F,27,15
SilphCo3F,3,15,SilphCo5F,3,15
SilphCo4F,3,15,SilphCo10F,13,15
SilphCo4F,17,3,SilphCo6F,3,3
SilphCo4F,11,7,SilphCo10F,9,11
SilphCo4F,17,11,SilphCo10F,13,7
SilphCo5F,27,3,SilphCo7F,21,15
SilphCo5F,9,15,SilphCo9F,17,15
SilphCo7F,5,7,SilphCo11F,3,2
SilphCo8F,3,11,SilphCo8F,11,9
CeruleanCave1F,23,7,CeruleanCave2F,22,6
CeruleanCave1F,27,1,CeruleanCave2F,29,1
CeruleanCave1F,18,9,CeruleanCave2F,19,7
CeruleanCave1F,7,1,CeruleanCave2F,9,1
CeruleanCave1F,1,3,CeruleanCave2F,1,3
CeruleanCave1F,3,11,CeruleanCave2F,3,11
CeruleanCave1F,0,6,CeruleanCaveB1F,3,6
VermilionDock,14,3,SSAnne1F,27,0
SSAnne1F,7,8,SSAnne1FRooms,0,0
SSAnne1F,11,8,SSAnne1FRooms,5,0
SSAnne1F,15,8,SSAnne1FRooms,10,0
SSAnne1F,19,8,SSAnne1FRooms,15,0
SSAnne1F,23,8,SSAnne1FRooms,20,0
SSAnne1F,31,8,SSAnne1FRooms,26,0
SSAnne1F,37,15,SSAnneB1F,27,5
SSAnneB1F,7,3,SSAnneB1FRooms,3,5
SSAnneB1F,11,3,SSAnneB1FRooms,8,5
SSAnneB1F,15,3,SSAnneB1FRooms,13,5
SSAnneB1F,19,3,SSAnneB1FRooms,18,5
SSAnneB1F,23,3,SSAnneB1FRooms,23,5
SSAnne1F,3,16,SSAnneKitchen,6,0
SSAnne1F,2,6,SSAnne2F,2,4
SSAnne2F,9,11,SSAnne2FRooms,3,5
SSAnne2F,13,11,SSAnne2FRooms,8,5
SSAnne2F,17,11,SSAnne2FRooms,13,5
SSAnne2F,21,11,SSAnne2FRooms,18,5
SSAnne2F,25,11,SSAnne2FRooms,23,5
SSAnne2F,29,11,SSAnne2FRooms,28,5
SSAnne2F,2,12,SSAnne3F,19,3
SSAnne2F,36,4,SSAnneCaptainsRoom,0,7
Route23,7,139,Route22Gate,4,0
Route23,8,139,Route22Gate,5,0
ViridianForestNorthGate,4,7,ViridianForest,1,0
ViridianForestNorthGate,5,7,ViridianForest,2,0
ViridianForestSouthGate,5,0,ViridianForest,15,47
ViridianForestSouthGate,5,0,ViridianForest,17,47
Route7,18,10,Route7Gate,5,4
Route7,11,10,Route7Gate,0,4
Route11,49,8,Route11Gate1F,0,4
Route11,49,9,Route11Gate1F,0,5
Route11,58,8,Route11Gate1F,7,4
Route11,58,9,Route11Gate1F,7,5
VermilionCity,19,35,VermilionDock,14,0
SSAnne3F,0,3,SSAnneBow,13,7
Route11Gate1F,6,8,Route11Gate2F,7,7
Route15,7,8,Route15Gate1F,0,4
Route15,7,9,Route15Gate1F,0,5
Route15,14,8,Route15Gate1F,7,4
Route15,14,9,Route15Gate1F,7,5
Route15Gate1F,6,8,Route15Gate2F,7,7
Route18,33,8,Route18Gate1F,0,4
Route18,33,9,Route18Gate1F,0,5
Route18,40,8,Route18Gate1F,7,4
Route18,40,9,Route18Gate1F,7,5
Route18Gate1F,6,8,Route18Gate2F,7,7
Route16,17,10,Route16Gate1F,0,8
Route16,17,11,Route16Gate1F,0,9
Route16,17,4,Route16Gate1F,0,2
Route16,17,5,Route16Gate1F,0,3
Route16,24,4,Route16Gate1F,7,2
Route16,24,5,Route16Gate1F,7,3
Route16,24,10,Route16Gate1F,7,9
Route16Gate1F,6,12,Route16Gate2F,7,7
PowerPlant,0,11,Route10,6,40
PokemonMansion1F,27,27,CinnabarIsland,6,4
PokemonMansion3F,16,13,PokemonMansion1F,14,14
PokemonMansion3F,17,13,PokemonMansion1F,15,14
PokemonMansion3F,19,13,PokemonMansion1F,17,14
LoreleisRoom,5,0,BrunosRoom,5,11
BrunosRoom,5,0,AgathasRoom,5,11
CeladonCity,25,3,CeladonMansion1F,4,0
CeladonMansion1F,2,1,CeladonMansion2F,2,1
CeladonMansion2F,4,1,CeladonMansion3F,4,1
CeladonMansion3F,2,1,CeladonMansionRoof,2,1
CeladonMansionRoof,2,7,CeladonMansionRoofHouse,3,7
RocketHideoutB1F,3,0,Route25,0,0
HallOfFame,0,1,RedsHouse2F,0,6
ViridianPokecenter,10,0,ViridianCity,21,16
ViridianPokecenter,12,0,ViridianCity,21,16
PewterPokecenter,10,0,ViridianCity,21,16
PewterPokecenter,12,0,ViridianCity,21,16
MtMoonPokecenter,10,0,ViridianCity,21,16
MtMoonPokecenter,12,0,ViridianCity,21,16
CeruleanPokecenter,10,0,ViridianCity,21,16
CeruleanPokecenter,12,0,ViridianCity,21,16
VermilionPokecenter,10,0,ViridianCity,21,16
VermilionPokecenter,12,0,ViridianCity,21,16
RockTunnelPokecenter,10,0,ViridianCity,21,16
RockTunnelPokecenter,12,0,ViridianCity,21,16
LavenderPokecenter,10,0,ViridianCity,21,16
LavenderPokecenter,12,0,ViridianCity,21,16
CeladonPokecenter,10,0,ViridianCity,21,16
CeladonPokecenter,12,0,ViridianCity,21,16
FuchsiaPokecenter,10,0,ViridianCity,21,16
FuchsiaPokecenter,12,0,ViridianCity,21,16
SaffronPokecenter,10,0,ViridianCity,21,16
SaffronPokecenter,12,0,ViridianCity,21,16
CinnabarPokecenter,10,0,ViridianCity,21,16
CinnabarPokecenter,12,0,ViridianCity,21,16
IndigoPlateauLobby,12,4,ViridianCity,21,16
IndigoPlateauLobby,14,4,ViridianCity,21,16)");

Warp::Warp(PokeMap *pm, int row, int col) : pm(pm), row(row), col(col) {}

std::string Warp::toString() const {
    return pm->name + "," + std::to_string(row) + "," + std::to_string(col);
}

void Warp::buildWarps() {
    for (const std::string &s : WARP_STRINGS) {
        std::vector<std::string> a = utils::split(s, ',');
        if (a.size() < 6) {
            continue;
        }
        PokeMap *m1 = PokeMap::POKEMAPS[a[0]];
        PokeMap *m2 = PokeMap::POKEMAPS[a[3]];
        int sr = std::stoi(a[2]);
        int sc = std::stoi(a[1]);
        int er = std::stoi(a[5]);
        int ec = std::stoi(a[4]);
        m1->addWarp(sr, sc, new Warp(m2, er, ec));
        if (a[3].size() >= 10 && a[3].rfind("Pokecenter") == a[3].size() - 10) {
            FlyLocation::FLY_LOCATIONS[FlyLocation::normalize(a[3])] = new FlyLocation(m1, sc, sr + 1);
        }
        m2->addWarp(er, ec, new Warp(m1, sr, sc));
    }
}
